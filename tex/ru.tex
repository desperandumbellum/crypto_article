

\documentclass[a4paper,11pt]{article}
\usepackage{amsmath,amssymb,amsfonts,amsthm, mathrsfs}
\usepackage{tikz}
\usepackage [utf8x] {inputenc}
\usepackage [T2A] {fontenc} 
\usepackage[russian]{babel}
\usepackage{cmap} 
\RequirePackage{caption}
\DeclareCaptionLabelSeparator{defffis}{. }
\captionsetup{justification=centering,labelsep=defffis}

\usepackage[mathscr]{eucal}
\usepackage{braket}
% Так ссылки в PDF будут активны
\usepackage[unicode]{hyperref}
\usepackage{mathtools}


% вы сможете вставлять картинки командой \includegraphics[width=0.7\textwidth]{ИМЯ ФАЙЛА}
% получается подключать, как минимум, файлы .pdf, .jpg, .png.
\usepackage{graphicx}
% Если вы хотите явно указать поля:
\usepackage[margin=1in]{geometry}
% Или если вы хотите задать поля менее явно (чем больше DIV, тем больше места под текст):
% \usepackage[DIV=10]{typearea}

\usepackage{fancyhdr}

\newcommand{\bbR}{\mathbb R}%теперь вместо длинной команды \mathbb R (множество вещественных чисел) можно писать короткую запись \bbR. Вместо \bbR вы можете вписать любую строчку букв, которая начинается с '\'.
\newcommand{\eps}{\varepsilon}
\newcommand{\bbN}{\mathbb N}
\newcommand{\dif}{\mathrm{d}}
\usepackage[cal=boondox]{mathalfa}

\pagestyle{fancy}
\makeatletter % сделать "@" "буквой", а не "спецсимволом" - можно использовать "служебные" команды, содержащие @ в названии
\fancyhead[L]{\footnotesize}%Это будет написано вверху страницы слева
\fancyhead[R]{\footnotesize Karamyshev Anton}
\fancyfoot[L]{\footnotesize \@author}%имя автора будет написано внизу страницы слева
\fancyfoot[R]{\thepage}%номер страницы —- внизу справа
\fancyfoot[C]{}%по центру внизу страницы пусто.
\renewcommand{\maketitle}{%
	\noindent{\bfseries\scshape\large\@title\ \mdseries\upshape}\par
	\noindent {\large\itshape\@author}
	\vskip 2ex}
\makeatother
\def\dd#1#2{\frac{\partial#1}{\partial#2}}

\usepackage{xcolor}

\begin{document}

\textbf{Abstract} --- Мы предлагаем четырехкубитный квантовый протокол распределения ключей, базирующийся на измерении двух состояния Белла. Кубиты объединяются в единый блок, передаваемый от отправителя к получателю в каждом сообщении. Шифрование здесь разработано путем случайной группировки четырех отдельных кубитов в две новые пары, такой механизм также является одним из способов обнаружить подслушивающее устройство в канале. В конечном счете, приемник случайным образом проверяет полученный блок при помощи двух измерений состояний Белла. Из сравнения информации о группировке этих четырех кубитов обе стороны соединения могут обнаружить нелегального пользователя в канале. В предложенном протоколе приемник обрабатывает блок мгновенно во время получения, что является эффективным способом преодоления ультракороткого времени хранения квантового состояния.



\section{INTRODUCTION}

Квантовое распределение ключей (QKD) является перспективной технологией защиты безопасности классической информации в квантовую эпоху [1]. Она позволяет двум сторонам обмениваться секретным ключом с безусловной безопасностью, который затем может быть использован для шифрования и расшифровки сообщений. В настоящее время опубликовано довольно много работ по данной тематике. В 1984 году Беннетт и Брассард впервые ввели протокол QKD, основанный на использовании двух взаимно несмещенных состояний поляризации фотонов [2]. Позднее Экерт предложил другой протокол QKD, который получил название E91, основанный на парадоксе Эйнштейна-Подольского-Розена (EPR) [3]. После этого были теоретически предложены и экспериментально реализованы различные протоколы QKD, такие как протоколы QKD, разработанные с однофотонными [4], множественными состояниями [5] и состоянием Белла [8]. Среди этих работ фотоны широко используются для переноса информации, поскольку ими легко манипулировать и они передают со скоростью света.

В качестве квантового канала состояние Белла было впервые предложено [6] и подтверждено как максимально запутанное состояние двухкубитной квантовой системы. По сравнению с другими мультикубитовыми состояниями, такими как состояние W, GHZ и кластерное состояние, состояние Белла легче всего реализовать с помощью нелинейного процесса [7]. В ссылке [8] две стороны разделяют секретный ключ, сравнивая форму начального состояния Белла и результат перекрутки. Затем [9] повысил общую эффективность коммуникации до 100\% по сравнению с первым 50\% в [8]. В [10] представлен первый аутентифицированный полуквантовый протокол распределения ключей без использования аутентифицированных классических каналов, основанных на состояниях Белла. В данной работе мы предлагаем протокол для предотвращения подслушивания с более низким коэффициентом ошибок при подтверждении и более коротким временем обнаружения ключевых битов, основанных на четырехкубитном состоянии, которое состоит из двух пар состояний Белла.

В нашем протоколе каждый раз подготавливается группа состоящая из четырёх кубитов, которая затем передаётся от отправителя к получателю. Приемник производит квантовое измерение состояния сразу после получения кубитов. По сравнению с двусторонними протоколами, в которых квантовое состояние должно сохраняться до завершения передачи в [8] и [9], наш протокол может преодолеть проблему времени ультракороткой когерентности квантовых состояний. Каждые четыре кубита образуют единый блок для передачи информации от отправителя к получателю в каждом сообщении. Четыре выхода посылаются отправителем в случайном порядке и принимаются получателем в некотором случайном групповом измерении. Наши расчеты показывают, что коэффициент ошибок при выходе составляет 4.17\%, что ниже, чем 46.875\% в [11]. Кроме того, только 11 бит необходимы для обнаружения подслушивающего устройства в нашем QKD протоколе, которое меньше 72 бит в BB84 протоколе [2] с тем же уровнем безопасности.
\section{QKD PROTOCOL BASED ON FOUR-QUBIT STATES}

\subsection{Квантовый канал на основе состояний Белла}
[8] и [9] предложили два протокола QKD, которые используют состояния Белла, распределенные между отправителем и получателем. В их протоколах две пары состояний Bell разделены между двумя сертифицированными сторонами связи. Отправитель и получатель хранят по два кубита, запутанные друг с другом. После одновременного измерения состояния Белла (BSM) с двух сторон реализуется квантовая запутанность уже между четырьмя кубитами.

Если давать более формальное описание, то можно обозначить четыре кубита двух состояний Белла как $P_1$, $P_2$, $P_3$ и $P_4$. Запутанность имеет место между $P_1$ и $P_2$, а также между $P_3$ и $P_4$. После измерения состояний Белла с обеих сторон запутанными оказываются $P_1$ и $P_3$, $P_2$ и $P_4$ соответственно. Однако обеим сторонам все равно необходимо хранить свои кубиты во время всего процесса коммуникации, и хранить кубиты в нужном состоянии довольно сложно в современном мире.


Учитывая ультракороткое время хранения кубитов, был предложен новый протокол QKD с четырехкубитной конфигурацией, состоящей из двух пар состояний Белла, выраженных уравнением (1). Группа состояний из четырех кубитов каждый раз подготавливается для незамедлительной отправки Бобу для измерения. Основное отличие от [8] и [9] заключается в том, что отправитель посылает сразу все кубиты приемнику, а приемник производит измерение квантового состояния сразу же после получения всей партии кубитов. Это односторонний процесс. Обеим сторонам не нужно продолжительное время хранить кубиты, так как кубиты измеряются незамедлительно после получения.


\begin{equation*}
\ket{\mathcal{C}}_{1234} = \ket{\Phi^-}_{12} \ket{\Phi^+}_{34}
= \dfrac{1}{2} \Big(\ket{\Phi^+}_{13} \ket{\Phi^-}_{24} + 
 					\ket{\Phi^-}_{13} \ket{\Phi^+}_{24} +
 					\ket{\Psi^+}_{13} \ket{\Psi^-}_{24} +
 					\ket{\Psi^-}_{13} \ket{\Psi^+}_{24} \Big),
\end{equation*}

где индексы $1$, $2$, $3$ и $4$ обозначают 4 связанных кубита. Состояние Белла выражается следующим образом:

\begin{equation*}
\ket{\Phi^{\pm}} = \dfrac{1}{\sqrt2}\big(\ket{00} \pm \ket{11} \big), \quad
\ket{\Psi^{\pm}} = \dfrac{1}{\sqrt2}\big(\ket{01} \pm \ket{10} \big).
\end{equation*}


Из (1) видно, что состояние становится суперпозицией четырех состояний, что означает, что мы можем получить четыре различных результата с помощью комбинаций состояний Белла. Обратим внимание, что уравнение (1) представляет только один особый случай, две другие формы с различными группировками кубитов для сравнения показаны в Таблице II. Вкратце, существует три формы случайной группировки этих четырех кубитов, из которых только уравнение (1) определено как правильное. Это основной метод шифрования информации во время коммуникации. Предлагаемый протокол показан на Рис. 1, где Алиса и Боб являются законными отправителем и приемником соответственно.

\subsection{Формирование ключей}

a) \textit{Шаг 1. Подготовка состояний.} Алиса подготавливает одну группу четырёхкубитных состояний, представленных в уравнении (1). Каждая такая группа состоит из четырёх кубитов $P_\gamma, \gamma \in \{1,2,3,4\}$. Для такого способа кодирования информация ключа $\mathcal{K}$ каждой группы состояний Белла представлена в таблице 1. Алиса запоминает текущее состоянии кубитов и соответствующую информацию ключа $\mathcal{K}$.

b) \textit{Шаг 2. Распределение кубитов.} Согласно уравнению (1), Алиса знает, что рассматриваемые четыре кубита сгруппированы как $\{(P_1, P_3), (P_2, P_4)\}$. Затем Алиса случайным образом переставляет эти четыре кубита и отправляет их Бобу по квантовому каналу.

c) \textit{Шаг 3. Измерение состояний Белла.} Боб принимает отправленные ему кубиты и случайным образом разделяет их на две части. После чего он выполняет измерение состояний Белла на этих двух частях и отправляет полученные результаты Алисе по классическому каналу.

d) \textit{Шаг 4. Сравнение результатов.} Алиса принимает эти результаты Боба и сравнивает их с сохранённой информацией о $P_\gamma$. Если Алиса получит совпадение, она объявит $'1'$ и весь процесс коммуникации может перейти к шагу $5$ или вернуться на шаг $1$. Если же совпадения нет, она объявит $'0'$ и процесс коммуникации начнётся сначала или оборвётся. Различные варианты группировки четырёх кубитов для Боба также приведены в таблице $2$.

e) \textit{Шаг 5. Получение согласованных ключей.} После нескольких итераций Алиса и Боб получают двоичную последовательность в виде необработанного ключа $\mathcal{R}$. Под $\mathcal{R}_A$ и $\mathcal{R}_B$ будем понимать необработанные ключи Алисы и Боба соответственно. Алиса случайным образом выбирает части $\mathcal{R}_A$ как свой ключ соглашения $\mathcal{C}_A$ и объявляет позиции данных выбранных частей. После чего Боб согласно этим позициям выбирает свой согласованный ключ $\mathcal{C}_B$ из ключа $\mathcal{R}_B$.

f) \textit{Шаг 6. Усиление конфиденциальности.} Боб выбирает набор битов $\mathcal{C}_B$ в качестве битов чётности $\mathcal{D}_B$ и объявляет $\mathcal{D}_B$ вместе с соответствующими позициями. Аналогичным образом Алиса выбирает свой набор $\mathcal{D}_A$ и сравнивает его с полученным $\mathcal{D}_B$. Если процент битовых ошибок в таком сравнении меньше некоторого наперёд заданного порога, то соединение может считаться безопасным и процесс коммуникации может перейти к следующему шагу $7$; если нет, то необходимо вернуться на шаг $1$ или же окончательно прервать связь.

g) \textit{Шаг 7. Формирование окончательных ключей.} На последнем шаге окончательно выбираются ключи $\mathcal{R}’_A$ и $\mathcal{R}’_B$, которые используются для шифрования в дальнейшем процесс коммуникации. Теоретически, $\mathcal{R}’_A$ = $\mathcal{R}’_B$, где $\mathcal{R}’_A$ --- это необработанный ключ $\mathcal{R}_A$ без битов $\mathcal{C}_A$ в идеальном случае, аналогично для $\mathcal{R}’_B$.

\subsection{Analyses of the qubit error rate with different groupings}

We can see that there are three different kinds of groupings from Table $2$ One is right, another two are wrong. Therefore, the probability of correctly grouping four qubits by Bob is $\frac{1}{3}$. If there is no eavesdropper in the communication channel, the qubit error rate $\varepsilon_0$, which is the threshold during one communication, can be calculated as following.

(1) Bob divides the four qubits into the wrong grouping $\{(P_1 , P_2), (P_3 , P_4)\}$.

\begin{equation*}
\ket{\mathcal{C}}_{1234} = \dfrac{1}{2} \Big(\ket{0000} + \ket{0011}
 + \ket{1100} + \ket{1111} \Big)_{1234} = 2 \Big(\ket{\Phi^-}_{12} \ket{\Phi^+}_{34}\Big).
\end{equation*}

In this case, he will only get $\ket{\Phi^-}_{12} \ket{\Phi^+}_{34}$. Bob will get the right binary random sequence $\mathcal{K} = 01$ with the probability of $\frac{1}{4}$ according to Table $1$.

(2) Bob gets the correct measurement results via the other wrong grouping, $\{(P_1, P_4), (P_2, P_3)\}$.

\begin{align*}
\ket{\mathcal{C}}_{1234} = \dfrac{1}{2} \Big(\ket{0000} + \ket{0011}
&+ \ket{1100} + \ket{1111} \Big)_{1234} \nonumber\\
 = \dfrac{1}{2} \Big(
\ket{\Phi^+}_{14} \ket{\Phi^-}_{23} + \ket{\Phi^-}_{14} \ket{\Phi^+}_{23} &+ 
\ket{\Psi^+}_{14} \ket{\Psi^-}_{23} + \ket{\Psi^-}_{14} \ket{\Psi^+} \Big).
\end{align*}

By BSM, he can obtain four correct measurement results $\{\ket{\Phi^+}, \ket{\Phi^-}\}$, $\{\ket{\Phi^-}, \ket{\Phi^+}\}$, $\{\ket{\Psi^+}, \ket{\Psi^-}\}$ and $\{\ket{\Psi^-}, \ket{\Psi^+}\}$. As a result, Bob will get the right binary random sequence $\mathcal{K}$ with the probability of $\frac{4}{4} = 1$ even he makes a wrong grouping.

In summary, the results of the BSM can only be partially right in the first case or totally right in the second case. Therefore, Bob can acquire the right binary random sequence
with the probability of $\frac{1}{2} \cdot \frac{1}{4} + \frac{1}{2} \cdot \frac{4}{4} = \frac{5}{8}$ when grouping wrongly. Hence, the qubit error rate $\varepsilon_0$ is,

\begin{equation*}
\varepsilon_0 = 1 - \Big(\dfrac{1}{3} + \dfrac{5}{8}\Big) = \dfrac{1}{24} = 0.0417.
\end{equation*}

Note that if Bob chooses the right grouping with probability $\frac{1}{3}$, he can obtain the right binary random sequence with the probability of $1$. Ultimately, the threshold in our protocol can be set to be $4.17\%$.

\section{SECURITY ANALYSES}
In this section, we analyze the security of our protocol under two major attacks: the intercept-resend attack and the Trojan Horse attack. Meanwhile, we assume the existence of
an eavesdropper Eve in the communication channel.

\subsection{The intercept-resend attack}
The eavesdropper Eve can interact and resend a new four-qubit state to Bob so that he can acquire the information of the state. In this case, Eve plays the same role as Bob does in the communication. He can group the four-qubit state and measure it with Bell bases.

After step $2$ of our protocol, the four qubits sent by Alice will transmit through the communication channel. Let’s assume that Eve intercepts these four qubits and processes
them in the same way as Bob does. Then, Eve resends his decoy four qubits to Bob. Let us discuss the different cases of the communication between Eve and Bob.

($1$) Eve chooses the right grouping and acquires the right measurement results. Bob simultaneously chooses the right grouping. Now, there are three parties, Alice, Bob and Eve
in the communication. There is a probability of $p_1$ that Eve can successfully filch the information,

\begin{equation*}
 p_1 = \Big(\dfrac{1}{3} \cdot 1 \Big)_{Eve} \times  \Big(\dfrac{1}{3} \cdot 1 \Big)_{Bob} = \dfrac{1}{9}.
\end{equation*}

(2) Similarly, Eve can divide the qubits and obtain the measurement results correctly. Then, he sends the right decoy four-qubit state to Bob. After receiving them, Bob chooses a wrong grouping but yields a right measurement result.

However, this group of state will be abandoned since in the comparison stage Alice and Bob can detect the wrong grouping.

\begin{equation*}
p_2 = \Big(\dfrac{1}{3}\cdot 1 \Big)_{Eve} \times \Big(\dfrac{2}{3}\cdot \dfrac{1}{4} + 
\dfrac{2}{3} \cdot \dfrac{5}{8} \Big)_{Bob} = \dfrac{14}{72}.
\end{equation*}

(3) Eve chooses a wrong grouping but he gets a right measurement result while Bob chooses a right grouping.

\begin{equation*}
p_3 = \Big(\dfrac{2}{3}\cdot \dfrac{1}{4} + 
\dfrac{2}{3} \cdot \dfrac{5}{8} \Big)_{Eve} \times \Big( \dfrac{1}{3}\cdot 1 \Big)_{Bob} = \dfrac{14}{72}.
\end{equation*}

(4) In the same way, Eve transmits the decoy state with a wrong grouping but Bob gets the right results. Meanwhile, Bob divides this decoy four-qubit state into wrong groups but
obtain the right measurement result. In this case, the qubits will be abandoned because of the wrong grouping of Bob.

\begin{equation*}
p_4 = Big(\dfrac{2}{3}\cdot \dfrac{1}{4} + 
\dfrac{2}{3} \cdot \dfrac{5}{8} \Big)_{Eve} \times \Big(\dfrac{2}{3}\cdot \dfrac{1}{4} + 
\dfrac{2}{3} \cdot \dfrac{5}{8} \Big)_{Bob} = \dfrac{49}{144}.
\end{equation*}

In conclusion, there is a probability that Bob gets a wrong measurement result, i.e., the qubit error rate with existence of eavesdropper in our protocol can be calculated as (8).

\begin{equation*}
\varepsilon_e = 1 - \Big(\dfrac{1}{9} + \dfrac{14}{72} + \dfrac{14}{72} + \dfrac{49}{144} \Big) = \dfrac{23}{144} = 0.1597.
\end{equation*}

Suppose Alice and Bob need to compare n bits of binary random sequence to detect Eve with the probability of $p_d = 0.999999999$ with

\begin{equation*}
p_d = 1 - (1-\varepsilon_e) = 1 - \Big(\dfrac{23}{144} \Big)^n.
\end{equation*}

We can find a minimum value of $n = 11$ from equation (9). On the other hand, in BB84 protocol, Alice and Bob need to compare $n = 72$ bits to detect Eve with the same probability. From the aforementioned analyses, we can calculate the mutual information between Alice, Bob and Eve. The mutual information between Alice and Bob is

\begin{equation*}
I(A; B) = 1 - [-(1-\varepsilon_0)log(1-\varepsilon_0) - \varepsilon_0 log \varepsilon_0] = 0.7501.
\end{equation*}

The mutual information between Alice and Eve is 
\begin{equation*}
I(A; E) = 1 - [-(1-\varepsilon_e)log(1-\varepsilon_e) - \varepsilon_e log \varepsilon_e] = 0.3664.
\end{equation*}

Therefore, the communication is secure since $I(A; B) > I(A; E)$. Furthermore, $I(A; B)$ in our protocol is greater than $I' (A; B) = 0.1887$ bit in BB84 protocol.
The theoretical secret key rate is
\begin{equation*}
R = I(A; B) - I(A; E) = 0.7501 - 0.3664 = 0.3837 > 0.
\end{equation*}

So, the binary random bits can be distilled after Alice and Bob perform key reconciliation and privacy amplification on the final key $\mathcal{R}'_A$ and $\mathcal{R}'_B$. The transmission distance $\mathcal{l}$ of the secret key is given by the qubit error rate $\varepsilon$ [12], which is:

\begin{equation*}
\varepsilon = \dfrac{\mu \eta 10^{- \frac{\alpha \mathcal{l}}{10}}}{\mu \eta 10^{- \frac{\alpha \mathcal{l}}{10}} + 2P_e}, 
\end{equation*}

where $\mu = 4$ is the averaged qubit flux leaving from Alice, $10^{- \frac{\alpha \mathcal{l}}{10}}$ represents the fiber attenuation through distance $\mathcal{l}$,
$\eta$ is the detection efficiency. Here, we set the channel loss to be $\alpha = 0.2$ and
$\alpha = 0.5$. Referring to [12], $P_e = 8.5 \cdot 10^{−7}$ is the probability of an error count per clock cycle. We set the values of $\eta$ to be $0.2$, $0.5$ and $0.99$.
Figure 2 shows the relation between $\mathcal{l}$ (km) and the qubit error rate $\varepsilon$. We can see that $\mathcal{l}$ decreases with the increase of the channel loss. Meanwhile, the higher the detection efficiency of the communication $\eta$ is, the larger the qubit error rate $\varepsilon$ is. From Fig. 2, we can infer that there exists a further distance when $\varepsilon_e$ = 0.0417 which is the qubit error rate in our protocol.

\begin{equation*}
 PLR = \dfrac{\sum_{m=1}^M C_M^m \pi_{\mathcal{On}}^m (1 - \pi_{\mathcal{On}})^{M-m} PLR (\hat{\lambda} = m\lambda)}
 {1 - (1 -\pi_{\mathcal{On}})^M}
\end{equation*}

\end{document}

